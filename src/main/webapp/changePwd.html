<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    <div class="title page-header">
        <h1>修改密码</h1>
    </div>
    <form class="form-horizontal" action="javascript:changePwdPage.save();">
        <div class="form-group">
            <div class="col-sm-4 input-group">
                <span class="input-group-addon">原密码</span>
                <input id="oldPwd" type="password" class="form-control" required/>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-4 input-group">
                <span class="input-group-addon">新密码</span>
                <input id="newPwd" type="password" placeholder="8-16位字母、数字组合" class="form-control" required/>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-4 input-group">
                <span class="input-group-addon">新密码确认</span>
                <input id="newPwdRepeated" type="password" placeholder="8-16位字母、数字组合" class="form-control" required/>
            </div>
        </div>
        <hr>
        <div class="form-group">
            <div class="col-sm-1"></div>
            <div class="col-sm-4 input-group">
                <input id="submitBtn" class="btn btn-primary" type="submit" value="提交"/>
                &nbsp;&nbsp;
                <input id="cancelBtn" class="btn btn-default" type="reset" value="重置"/>
            </div>
        </div>
    </form>
    <div id="cmModal"></div>
</div>
<script>
    var changePwdPage = {};
    (function (page) {
        var _data = {};
        page.save = function () {
            _data.phoneNumber = $.cookie("MERCHANT_USER_PHONE_NUMBER");
            _data.password = $("#oldPwd").val();
            _data.newPassword = $("#newPwd").val();
            var repeatedPwd = $("#newPwdRepeated").val();

            if (_data.newPassword !== repeatedPwd) {
                commonModal.showModal("两次输入的密码不一致！");
                return false;
            }

            $.ajax({
                type: "PUT", url: "/api/merchant/merchantUser/updateMerchantUserPassword",
                contentType: "application/json",
                data: JSON.stringify(_data),
                success: function (result) {
                    if (result.status === SUCCESS) {
                        commonModal.showModal("密码修改成功！");
                        $("#cancelBtn").click();
                    }
                    else
                        commonModal.showModal(result.data);
                }
            });
        };

        $(function () {
            $("#cmModal").load("commonModal.html");
        });
    })(changePwdPage);
</script>